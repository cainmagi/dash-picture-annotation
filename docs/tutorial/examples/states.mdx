---
id: states
sidebar_label: States
title: Example of changing the annotator state
description: The example of setting the properties of the annotator by the callback.
slug: /examples/states
---

import IconExternalLink from "@theme/Icon/ExternalLink";

import mdiLanguagePython from "@iconify-icons/mdi/language-python";

import {demoURL} from "@site/src/envs/variables";
import DarkButton from "@site/src/components/DarkButton";

# Example of changing the annotator state

<div className="float-right indark-inv">

|                  Example of changing the annotator state                   |
| :------------------------------------------------------------------------: |
| ![Example of changing the annotator state](/img/examples/demo-states.webp) |

</div>

Check the following link to review the demo of changing the states.

<p>
  <DarkButton to={demoURL("states.py")} icon={mdiLanguagePython}>
    {"states.py"}
  </DarkButton>
</p>

This demo provides the following features:

1. A basic [`DashPictureAnnotation`](../../apis/DashPictureAnnotation.mdx) allowing
   1. Creating, modify, or removing annotation boxes by dragging and dropping.
   2. Modify the annotation label by an input box.
2. Every time the annotation data is changed, the changed results will be reflected
   by the text below the annotator window.
3. Three controlling buttons:
   - <kbd>Toggle disabled</kbd>: Toggle the `disabled` property. When this
     property is enabled, the annotator is not usable.
   - <kbd>Toggle image</kbd>: Toggle the currently displayed image.
   - <kbd>Reset data</kbd>: Reset the annotation data to the initial state.

## Define the layout

Compared to the [minimal demo](./minimal.mdx), there are three additional buttons.

```python
(
    dpa.DashPictureAnnotation(...),
    html.Div(
        html.Button(
            children="Toggle disabled", id="btn-disabled", style=styles["mr1"]
        ),
        html.Button(
            children="Toggle image", id="btn-image", style=styles["mr1"]
        ),
        html.Button(children="Reset data", id="btn-data"),
    ),
)
```

By clicking different buttons, the different callbacks will be triggered for changing
the annotator states.

## Define the callbacks

The first button toggles the state of the `disabled` property. It just read and flip
the current `disabled` property.

```python showLineNumbers
@app.callback(
    Output("annotator", "disabled"),
    Input("btn-disabled", "n_clicks"),
    State("annotator", "disabled"),
    prevent_initial_call=True,
)
def toggle_disabled(n_clicks: Optional[int], is_disabled: Optional[bool]):
    if n_clicks:
        # highlight-next-line
        return not bool(is_disabled)
    return dash.no_update
```

The second callback read and roll the current image. It read the current image address,
get the name of the image from the address, and use the image name to query the next
image address that should be displayed.

```python showLineNumbers
@app.callback(
    Output("annotator", "image"),
    Input("btn-image", "n_clicks"),
    State("annotator", "image"),
    prevent_initial_call=False,
)
def toggle_image(n_clicks: Optional[int], prev_image: Optional[str]) -> str:
    if n_clicks:
        if isinstance(prev_image, str):
            try:
                # highlight-next-line
                idx = image_list.index(os.path.split(prev_image)[-1])
            except ValueError:
                return "/assets/test_image.svg"
            # highlight-next-line
            next_idx = (idx + 1) % len(image_list)
            return "/assets/{0}".format(image_list[next_idx])
    return "/assets/test_image.svg"
```

The third callback reset the current annotation data to the initial value.

```python showLineNumbers
@app.callback(
    Output("annotator", "data"),
    Input("btn-data", "n_clicks"),
    prevent_initial_call=False,
)
def reset_data(n_clicks: Optional[int]):
    if n_clicks:
        # highlight-next-line
        return default_data
    return dash.no_update
```
